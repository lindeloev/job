<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using job::export() to control exports from RStudio Jobs • job</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Using job::export() to control exports from RStudio Jobs">
<meta property="og:description" content="job">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@jonaslindeloev">
<meta name="twitter:site" content="@jonaslindeloev">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-1026978-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-1026978-3');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">job</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Usage and cases
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/import.html">Controlling import</a>
    </li>
    <li>
      <a href="../../articles/articles/export.html">Controlling export</a>
    </li>
    <li>
      <a href="../../articles/articles/robust.html">Error robustness</a>
    </li>
    <li>
      <a href="../../articles/articles/testing.html">Case: Testing code</a>
    </li>
    <li>
      <a href="../../articles/articles/plot.html">Case: Rendering large plots</a>
    </li>
    <li>
      <a href="../../articles/articles/routines.html">Other routine tasks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li>
  <a href="../../news/index.html">News</a>
</li>
<li>
  <a href="https://twitter.com/jonaslindeloev">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/lindeloev/job">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="export_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using job::export() to control exports from RStudio Jobs</h1>
            
      
      
      <div class="hidden name"><code>export.Rmd</code></div>

    </div>

    
    
<p>Use <code><a href="../../reference/export.html">job::export()</a></code> to control what is returned from a job. The documentation for <code><a href="../../reference/export.html">job::export()</a></code> includes code examples and may be useful to read first. In this article, we’ll discuss situations where it definitely makes sense to deviate from this default. Check out the related <a href="../articles/import.html">article on controlling imports to a job</a>.</p>
<p><code><a href="../../reference/export.html">job::export()</a></code> should be called as the last command in the job. If it isn’t called, <code>job</code> defaults to calling <code><a href="../../reference/export.html">job::export("changed", file = NULL)</a></code>.</p>
<div id="ignore-temporary-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#ignore-temporary-objects" class="anchor"></a>Ignore temporary objects</h2>
<p>Use <code><a href="../../reference/export.html">export(c(main, results))</a></code> to keep the export small and uncluttered. This is useful if you have many or large intermediate objects. For example, here we do some data preprocessing, but only return the final dataset and the model fit:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">job</span><span class="fu">::</span><span class="fu"><a href="../../reference/job.html">job</a></span><span class="op">(</span><span class="op">{</span>
  <span class="co"># Select some data</span>
  <span class="va">rows</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>
  <span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"cyl"</span>, <span class="st">"hp"</span><span class="op">)</span>
  <span class="va">df</span> <span class="op">=</span> <span class="va">mtcars</span><span class="op">[</span><span class="va">rows</span>, <span class="va">cols</span><span class="op">]</span>
  
  <span class="co"># Fit and export</span>
  <span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">df</span><span class="op">)</span>
  <span class="fu"><a href="../../reference/export.html">export</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">fit</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="when-the-main-result-is-not-an-object" class="section level2">
<h2 class="hasAnchor">
<a href="#when-the-main-result-is-not-an-object" class="anchor"></a>When the main result is not an object</h2>
<p>Sometimes, a text output is the most interesting, e.g., when your job contains something like <code><a href="https://rdrr.io/r/base/print.html">print(summary(fit))</a></code>. In these cases, just call <code><a href="../../reference/export.html">job::export("none")</a></code> on the last line of the code chunk to prevent the job from returning intermediate objects to the main session (or a file).</p>
</div>
<div id="export-to-file" class="section level2">
<h2 class="hasAnchor">
<a href="#export-to-file" class="anchor"></a>Export to file</h2>
<p>If you just want to output to a file, I recommend using <code><a href="https://rdrr.io/r/base/readRDS.html">saveRDS()</a></code> for single objects or <code><a href="../../reference/export.html">export(..., file = "filename.RData")</a></code> for multiple objects. You can use relative paths for the file name because the job runs in the same working directory as your RStudio session. Example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">job</span><span class="fu">::</span><span class="fu"><a href="../../reference/job.html">job</a></span><span class="op">(</span><span class="op">{</span>
  <span class="va">d</span> <span class="op">=</span> <span class="st">"I am dee"</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"d_object.rds"</span><span class="op">)</span>  <span class="co"># Save single objects</span>
  <span class="va">b</span> <span class="op">=</span> <span class="st">"I am bee"</span>
  <span class="fu">job</span><span class="fu">::</span><span class="fu"><a href="../../reference/export.html">export</a></span><span class="op">(</span><span class="st">"changed"</span>, file <span class="op">=</span> <span class="st">"my_environment.RData"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p>When you use the <code><a href="../../reference/export.html">job::export(..., file)</a></code> argument, it implicitly calls <code><a href="../../reference/export.html">job::export("none")</a></code> after saving, i.e., returns nothing to the main session. To load the objects into your main session (or another job), simply:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load single object</span>
<span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"d_object.rds"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>  <span class="co"># "I am ae"</span>

<span class="co"># Load into global </span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"my_environment.RData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span>  <span class="co"># "I am bee"</span>

<span class="co"># Load into environment</span>
<span class="va">job_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html">new.env</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"my_environment.RData"</span>, envir <span class="op">=</span> <span class="va">job_result</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">job_result</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>  <span class="co"># "I am bee"</span></code></pre></div>
<p>You can also use <code><a href="https://rdrr.io/r/base/save.html">save()</a></code> and <code><a href="https://rdrr.io/r/base/save.html">save.image(envir = sys.frame(sys.nframe()))</a></code> inside the code chunk. The latter will include two functions called <code>emitProgress()</code> and <code>sourceWithProgress()</code> are set by RStudio.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://lindeloev.net">Jonas Kristoffer Lindeløv</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '702ab134d40a7310606c29f341fc5014',
    indexName: 'lindeloev_job',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
